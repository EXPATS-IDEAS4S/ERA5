#!/usr/bin/env python
import cdsapi

c = cdsapi.Client()

times = ["00:00", "06:00", "12:00","18:00"]
days = [f"{day:02d}" for day in range(1, 32)] 
month = "07"
year = "2023" 
area = "52/5/42/16" # North, West, South, East.
path_save = "/work/NWC_GEO/import/NWP_data/"

for day in days:
    c.retrieve("reanalysis-era5-complete", {
        "date": year+'-'+month+'-'+day, #"2021-07-14",
        "levtype" : "sfc",
        "param": "7.228/8.228/9.228/10.228/11.228/12.228/13.228/14.228/15.128/16.128/17.128/18.128/26.128/27.128/28.128/29.128/30.128/31.128/32.128/33.128/34.128/35.128/36.128/37.128/38.128/39.128/40.128/41.128/42.128/43.128/53.162/54.162/59.128/59.162/60.162/61.162/62.162/63.162/64.162/65.162/66.128/66.162/67.128/67.162/68.162/69.162/70.162/71.162/72.162/73.162/74.128/74.162/75.162/76.162/77.162/78.128/78.162/79.128/79.162/80.162/81.162/82.162/83.162/84.162/85.162/86.162/87.162/88.162/89.162/89.228/90.162/90.228/91.162/92.162/129.128/131.228/132.228/134.128/136.128/137.128/139.128/141.128/148.128/151.128/159.128/160.128/161.128/162.128/163.128/164.128/165.128/166.128/167.128/168.128/170.128/172.128/183.128/186.128/187.128/188.128/198.128/206.128/229.128/230.128/231.128/232.128/235.128/236.128/238.128/243.128/244.128/245.128/246.228/247.228",#"172.128/129.128",
        "stream": "oper",
        "time": times,
        "type": "an",
        "grid" : "0.2/0.2",
        "format" : "grib",
        "area" : area                 
        },path_save+year+'-'+month+'-'+day+'_1.grib')

    c.retrieve("reanalysis-era5-complete", {
        "date": year+'-'+month+'-'+day, #"2021-07-14",
        "levelist": "10/30/50/70/100/150/200/250/300/400/500/700/850/925/1000",
        "levtype": "pl",
        "param": "60.128/75.128/76.128/129.128/130.128/131/132/133.128/135.128/138.128/155.128/157.128/203.128/246.128/247.128/248.128",#"130.128/157.128/129.128/203.128/131.128/132.128",
        "stream": "oper",
        "time": times,
        "type": "an",
        "grid" : "0.2/0.2",
        "format" : "grib",
        "area" : area                 
        },path_save+year+'-'+month+'-'+day+'_2.grib')


    # c.retrieve("reanalysis-era5-complete", {
    #     "date": year+'-'+month+'-'+day, #"2021-07-14",
    #     "levelist": "off",
    #     "levtype" : "sfc",
    #     "param": "167.128/139.128/235.128/134.128/137.128/168.128/164.128/206.128/165.128/166.128",
    #     "stream": "oper",
    #     "time": times,
    #     "type": "an",
    #     "grid" : "0.2/0.2",
    #     "format" : "grib",
    #     "area" : area                
    #     },path_save+year+'-'+month+'-'+day+'_3.grib')
